---
title: 面经
date: 2022-04-18 16:58:50
categories:
- CS
- 面经
tags:
- security
toc: true
---
**摘要：面经**
<!-- more -->
# 自我介绍
您好，我叫张仕炫，今年21岁，来自清华大学电子信息科学与技术专业，然后现在是在念大三。然后是这学期开始对网络安全感兴趣，开始自学了一部分web安全知识和逆向工程的知识，然后也是对渗透测试和红蓝攻防这方面很感兴趣。为了提升自己在网络安全这方面的能力，我曾经在清华网络研究院和中科院信工所六室那边实习，学过一些工具的使用比如burp、sqlmap，也会用IDA、gdb这些调试工具对程序进行逆向分析。然后主要使用的编程语言是C++和C，也略微了解一点python,mysql和汇编语言。然后做过的项目有用verilog写过一个MIPS流水线处理器，然后是用C++写过一个比较简单的学生成绩后台管理系统，大一的时候还做过一个双轮自平衡循迹小车参加了校内的硬件设计大赛并且得到优秀作品。现在是在做一个对设计模式进行逆向分析的项目。然后非常希望暑期可以来绿盟这边实习接触一些实战，跟一些师傅和导师学习一下。
# 问题
1.公司对实习生的培养模式是什么呢
2.实习地点是在北京吗
3.公司可以给开实习证明吗，因为学校这边实习是算学分的，需要实习证明
4.您认为我的表现怎么样，接下来应该提高哪方面呢
5.接下来的安排?还有面试吗
# 一.二进制
## 1.如何快速判断一个文件是否为病毒？
把程序copy到虚拟机里，用sandbox运行程序。
查看是否有捆绑运行等行为，查看网络是否有可疑端口向外网IP连接。查看是否有对文件操作的可疑行为。结束sandbox里的程序，查看各个目录与临时目录下释放的文件。
## 2.病毒和木马有何区别？
各类病毒的共同特征是自我复制、传播，破坏计算机系统。
木马主要是黑客用来潜入宿主计算机，进行信息窃取的程序。
## 3.如何判断一个文件是可执行文件？
 可执行文件就是PE(Portable Executable)格式的文件，其拓展名可以是EXE、DLL、ELF、OCX、SYS、COM等
## 4、gdb常见调试命令
（gdb）help：查看命令帮助，具体命令查询在gdb中输入help + 命令,简写h
（gdb）run：重新开始运行文件（run-text：加载文本文件，run-bin：加载二进制文件）,简写r
（gdb）start：单步执行，运行程序，停在第一执行语句
（gdb）list：查看原代码（list-n,从第n行开始查看代码。list+ 函数名：查看具体函数）,简写l
b:下断点
r:运行程序
（gdb）print：打印值及地址,简写p
（gdb）set：设置变量的值
（gdb）next：单步调试（逐过程，函数直接执行）,简写n
（gdb）step：单步调试（逐语句：跳入自定义函数内部执行）,简写s
（gdb）info：查看函数内部局部变量的数值,简写i
（gdb）finish：结束当前函数，返回到函数调用点
（gdb）continue：继续运行,简写c
（gdb）quit：退出gdb,简写q
（gdb）watch：被设置观察点的变量发生修改时，打印显示
（gdb）x：查看内存x/20xw 显示20个单元，16进制，4字节每单元
## 5.简述一下C++ 从代码到可执行二进制文件的过程
C++ 从代码到可执行二进制文件经过四个过程，分别是：预编译、编译、汇编、链接。
1. 预编译，主要的处理操作：
a.将所有的 #define 删除，并且展开所有的宏定义（宏替换）
b.处理所有的条件预编译指令，如 #if、#ifdef
c.处理 #include 预编译指令，将被包含的文件插入到该预编译指令的位置
d.删除所有的注释
e. 添加行号和文件名标识
2. 编译：将预处理之后的代码转换成特定的汇编代码，主要包括词法分析、语法分析、语义分析、优化代码等操作
3. 汇编：将汇编代码汇编成机器指令
4. 链接：将不同源文件生成的目标代码以及其它目标代码、库文件组合起来，从而形成可执行程序
加分回答
链接分为静态链接和动态链接。
1. 静态链接：静态链接是由链接器在链接时将库的内容加入到可执行程序中，将一个或多个库或目标文件（先前由编译器或汇编器生成）链接到一块生成可执行程序。
2. 动态链接：动态链接在链接后动态库仍然与可执行文件分离，直到运行时才动态加载。


# 二、网络基础
## 1.osi / tcp-ip / 原理体系架构
![20220508195345](https://s2.loli.net/2022/05/08/vtC2AaemflZNDw3.png)
```
应用层                                      
运输层
网际层(IP:Internet Protocol（网际互连协议）)
网络接口层
```
## 2.三次握手
三次握手是指建立一个 TCP 连接时，需要客户端和服务器总共发送3个包
第一次握手([SYN], Seq = x) 客户端发送一个SYN标记的包，Seq初始序列号x，发送完成后客户端进入SYN_SEND状态
第二次握手([SYN,ACK], Seq = y, ACK = x + 1)服务器返回确认包(ACK)应答，同时还要发送一个SYN包回去。ACK = x + 1,表示确认收到(客户端发来的Seq值 + 1)，Seq= y, 表示让客户端确认是否能收到。发送完成后服务端进入SYN_RCVD状态
第三次握手([ACK], ACK = y + 1) 客户端再次发送确认包(ACK),ACK = y + 1,表示确认收到服务器的包（服务端发来的Seq值 +1）。客户端发送完毕后，进入ESTABLISHED状态，服务端接收到这个包，也进入ESTABLISHED状态, TCP握手结束

为什么要建立TCP连接要三次握手呢？
为了确认客户端和服务器的接收与发送能力是否正常
第一次握手：客户端向服务器发送包，服务端收到了。这样服务端就能知道：客户端的发送能力、服务端的接收能力是正常的
第二次握手：服务端向客户端发送确认包应答，客户端收到了。这样客户端就能知道：服务端的接收、发送能力，客户端的接收、发送能力是正常的。不过此时服务器并不能确认客户端的接收能力是否正常
第三次握手：客户端再次发送确认包，服务端收到了。这样服务端就能得知道：客户端的接收、发送能力正常，服务器自己的发送、接收能力也正常
## 3.四次挥手
断开一个TCP连接,需要客户端与服务器发送四个包来确认连接的断开。由于断开连接的过程中是保证数据不再发送了,才能够断开
因为TCP是全双工的,因此,每个方向都要单独关闭
当一方完成数据发送任务后,发送一个FIN来终止这一方向的连接,收到一个FIN只是意味着
一方向不会再收到数据了,但是这个TCP连接上仍然能够发送数据,直到这一方也发送了FIN.
首先进行关闭的一方执行主动关闭,另一方执行被动关闭.第一个关闭的最后等待2MSL
第一次挥手:Client将FIN置为1,序号seq=M,发送给Server,进入FIN_WAIT_1状态
第二次挥手：Server收到后,将ACK置为1,ack=M+1,响应给Client,进入CLOSE_WAIT状态
Client收到响应后,进入FIN_WAIT_2状态
第三次挥手：Server在结束所有数据传输后,将Fin置为1,seq=N+1,发送给Client,进入
LAST_ACK状态
第四次挥手：Client收到后,将ACK置为1,ack=N+1,响应给Server,进入TIME_WAIT状态,等待
    2MSL后,进入CLOSED状态
Server收到后,进入CLOSED状态
![20220515011033](https://s2.loli.net/2022/05/15/rTFxpLO4U9vZJ12.png)

## 4.IP协议的首部结构 
首部协议一共是20个字节（固定）
第一个4字节： 版本号；首部长度； 服务类型；总长度；
第二个4字节：标识；标志；片偏移；
第三个4字节：生存时间；协议；校验和；
第四个4字节：源ip地址；
第五个4字节：目的ip地址；

# 三、web安全
## 1.常见的报错注入函数
如果我们的输入能引起数据库报错就可以用报错注入，比较常规的就三个updatexml、extractvalue、floor
floor函数向下取整函数，经常搭配计数函数count和伪随机数函数rand使用

extractvalue(参数1，参数2)

参数1：xml文档字符串
参数2：xpath格式字符串

该函数主要用来查找并解析xml文档

updatexml(参数1，参数2，参数3)

参数1：xml文档字符串
参数2：xpath格式字符串
参数3：替换字符串

该函数主要用来查找替换并解析xml文档，但是不会保存到数据库

两个函数的报错原理其实都一样，都是因为第二个参数不采用xpath格式的字符导致数据库报xpath格式错误，利用concat()函数把一个特殊字符与xpath连接在一起就可以报错。

## 2.文件上传的漏洞原因
开发者没有对上传的文件后缀名作检测和过滤
防护方法有：黑白名单、单独创建一个上传目录限制权限、放沙盒、加上特殊字符过滤机制
绕waf方法：
先判断是客户端检测还是服务端检测，如果是客户端就通过 burp抓包中间人绕过
文件幻数检测：在文件幻数后面加上木马
文件大小检测：就在一个完整的文件插入木马
文件后缀名检测：尝试一些不在黑名单的后缀名，大小写，下划线表示空格绕过
中间解析件绕过(IIS5和6、apache)

## 3.burp有哪些功能
它的核心功能就是抓包改包，其次它的爬虫(将目标网站所有的网页让工具走一遍，然后配合filter找出有参数的页面)、扫描,然后repeater模块可以改一些payload(关键信息)然后重复发送请求，intruder模块可以爆破字典，还有编解码，一些插件比如说CO2也很有用，可以配合sqlmap

## 4.dirsearch/dirmap
扫目录的功能,自己尝试写(go,python)
整体的功能模块：指定一个字典让它去扫,api探测,对404页面做判断(404并不一定没有东西，有时候那个路径下还有一层递归)
要加快扫描速度有2种方法：多线程、异步
有时404页面会在后端统一处理成200，要怎么检测这种错误页面：
可以输入一个随机字符串作为目录路径，如果返回200，把这个页面记录下来，用python里的dif来判断相似度，如果相似度很高就可以认为这个页面是错误页面

## 5.sqlmap
os-shell的原理(mysql)：可以执行系统命令，一般是先传一个马作为一个上传，再传一个马作为命令执行，退出的时候会自动把马清除掉

## 6.sql注入绕waf的方式
跑关键字字典，

## 7.IIS搭建的网站如何找漏洞？
先看版本(5和6)

## 8.XSS除了盗取Cookie还能干嘛？
转发邮件、记录键盘、钓鱼、转发邮件、刷流量
劫持后台、纂改页面、

## 9.手工检测webshell
正则表达式检测pHp,eval之类的

## 10.正向连接和反向连接
在要攻击的服务器有端口，从我这边直接连到它
在要攻击的服务器上运行个程序，使它连接我

## 11.写爬虫有哪些常用的模块？
request,正则函数,beautifulsoup4,

## 12.eval和system区别

## 13.拿到一个靶机ip后
1.拿到ip后可用nmap -sV探测其开放的服务端口(http,ssh,https)
```
nmap -sV IP  探测开放的服务和服务的版本
nmap -A IP 探测全部信息
nmap -O IP 探测操作系统类型和版本
```
2.http端口看一下页面内容和源代码(尤其是联系人等信息很可能就是ssh的用户名信息)
3.dirb/dirsearch/nikto/御剑爆破当前端口的目录(爆特定文件 -X php)，递归访问，力争把每个扫描到的目录页面都看一下,有没有什么奇怪的文件名
4.对于开发ssh服务的，看看能否拿到id_rsa
注意特殊端口(>1024的端口是用户自行支配的，特别敏感，日常用的是0~1023，)

## 14.ssh 远程登录
![20220516212125](https://s2.loli.net/2022/05/16/wTJmhr9DUBjXOqZ.png)
![20220516212245](https://s2.loli.net/2022/05/16/wL47BKDNxkIzPhd.png)
认证方式：我们要拿到私钥，和服务器上的公钥进行对比，对比成功即可登录服务器(看到页面的字符内容要想到是否是一个文件)
对于ssh服务的22端口，考虑两种方法：暴力破解和私钥泄露
1.先尝试通过私钥文件登录，先查看私钥文件权限(ls -alh)
2.赋予私钥文件可读可写的权限(chmod 600 文件)
3.ssh -i 私钥文件 用户名@主机ip
4.如果需要密码(密码爆破神器hydra)，继续识别私钥文件(sshjohn 私钥文件 > 输出到的转换后的文件)
5.zcat /user/share/wordlists/rockyou.txt.gz | john --pipe --rules rsacrack(用rsacrack的规则通过管道传给john)
6.登录到主机，但不是root用户，可以先查看下root文件夹有没有flag
7.-find / -perm -4000 2>/dev/null(查看具有root权限的文件，并不报错)
8.找栈溢出漏洞 SimonAAAAA/bin/sh

## 15.信息收集
子域名查询：就是在域名前面加上.和一些字符
```
域名	
	zkaq.cn# 顶级域名
	bbs.zkaq.cn # 子域名
	www.zkaq.cn # 子域名
```
端口：电脑传输数据的一个通道，一般对应一个服务
1.目录/敏感文件扫描
2.js接口探测->能发现很多未授权方面的漏洞 jsfinder
burp插件 jsfinder
3.网站源码 中间件 --wappalyzer浏览器插件
4.谷歌语法 最大作用：过滤搜索内容
```
+充值 -支付 # +代表必须带关键字，-代表必须减去关键字
	“酒店管理” # 作为整体进行搜索
	site:baidu.com # 搜出来的网站的域名 必须是baidu.com
	inurl:？id # 搜出来的网站的网址必须带有？id
	intitle：充值 # 标题里面必须带有充值
	intext：充值 # 正文必须带有充值
	filetype:pdf # 找资源 --限制文件类型
```
5.密码爆破:hydra和crunch
支持全平台和协议
windows:https://github.com/maaaaz/thc-hydra-windows 
```
-R：继续从上一次进度开始破解
-S：大写，采用SSL链接(https
-s：小写，指定端口
-l：指定破解的用户，对特定用户破解(找到用户名后)
-L：指定用户名字典，爆破用户名
-P：大写，指定密码字典
-e：nsr，n:空密码破解 s：使用的user作为密码破解  r：反向密码
-o：指定结果输出文件
-t：同时运行的线程数，交替为16
-w：设置最大超时的时间，单位秒，每次是30s
```
```
SMB服务很稳定，跑得快，不容易ban掉ip
hydra -l 用户名 -P 密码字典 smb://ip –v
Windows远程登陆密码破解：
hydra -l 用户名 -p 密码 rdp://ip –v
破解ssh
hydra -l 用户名 -P 密码字典 -t 线程 -vV -e nsr ip ssh
```
6.子域名查询
```
1.谷歌语法
2.证书搜索https的网站：https://crt.sh/
3.基于DNS查询DNS解析记录：能返回子域名和IP
https://dns.bufferover.run/dns?q=目标域名如 xx.com
4.爆破：Sublist3r 子域名挖掘机(设置域名层数)
```
只要你收集到目标的一些模糊的信息，就可以针对性生成一个字典用来爆破。知道密码的一部分细节后，可以针对性的生成字典。
7.地理位置查询
seeker和ngrok


---
# 总结

---
# 参考资料
