---
title: 计算机网络学习笔记
date: 2022-04-18 16:58:50
categories:
- CS
- security
tags:
- web
toc: true
---
**摘要：星学院学习笔记**
<!-- more -->
---
# 一、http
http协议是无状态协议，不对请求和响应之间的通信状态进行保存，即不做持久化处理，这是为了处理大量的请求，确保协议的可伸缩性。但现在有了cookie可以管理状态

![20220510215743](https://s2.loli.net/2022/05/10/YM5jICXtAZBGv6p.png)
## http报文
![20220511203810](https://s2.loli.net/2022/05/11/epE41L8HhNcoQqy.png)
![20220511203830](https://s2.loli.net/2022/05/11/NQlqHpvUIrzB2WK.png)
![20220511203844](https://s2.loli.net/2022/05/11/oG5pql4tNbCTaUk.png)
![20220511203856](https://s2.loli.net/2022/05/11/wNgn5DxO2pTW69C.png)
![20220511203908](https://s2.loli.net/2022/05/11/hWYsKmx6XnGJpFD.png)
![20220511203958](https://s2.loli.net/2022/05/11/VAGOsy129hQLxW8.png)
## http首部字段
![20220511201825](https://s2.loli.net/2022/05/11/P4Frw1SGZJg3UTj.png)
![20220511201855](https://s2.loli.net/2022/05/11/HvBhp5SFDwYn7tW.png)
### 通用首部字段
![20220511201948](https://s2.loli.net/2022/05/11/6QIcdVN5gJymW12.png)
![20220511202113](https://s2.loli.net/2022/05/11/DwlbU2j4YyFEuG1.png)
### 请求首部字段
![20220511202220](https://s2.loli.net/2022/05/11/JBejI7LZYWkq2Ew.png)
![20220511202423](https://s2.loli.net/2022/05/11/nLyHwGNsuO9USTR.png)
![20220511202456](https://s2.loli.net/2022/05/11/nxBVKHDyUGwq75d.png)
![20220511202725](https://s2.loli.net/2022/05/11/sRvpDBS5Im4Vqaw.png)
### 响应首部字段
![20220511202832](https://s2.loli.net/2022/05/11/XEHUjVuldr37O5f.png)
![20220511202959](https://s2.loli.net/2022/05/11/l9NZYjRHQeozKPk.png)
![20220511203116](https://s2.loli.net/2022/05/11/952hSk7biJuNoTt.png)

### 实体首部字段(在响应生成的内容)
![20220511203226](https://s2.loli.net/2022/05/11/2MPHJrC5NmqUxAe.png)
![20220511203234](https://s2.loli.net/2022/05/11/G8dJhbrwXYD5qm2.png)

# 二、web漏洞
## sql注入
![20220511205215](https://s2.loli.net/2022/05/11/ycKjh3PnAOUbwo4.png)
![20220511205407](https://s2.loli.net/2022/05/11/xkrjRy67c1b9AUH.png)
第二、三种方法可绕过
![20220511210254](https://s2.loli.net/2022/05/11/VR3ZrgmXIG8oUpu.png)

## xss注入(跨站脚本攻击,Cross SiteScript)
![20220511210509](https://s2.loli.net/2022/05/11/v9Wqt2wQg3UVSpO.png)
下两行是传回的回显，将用户输入的title毫无处理地返回了前端，如果用户在title位置输入了一段js脚本，在渲染js页面时就会触发js脚本
![20220511210722](https://s2.loli.net/2022/05/11/XSm7VMy5caPHr23.png)
![20220511210813](https://s2.loli.net/2022/05/11/wNtaysr3GDVM87o.png)
![20220511210856](https://s2.loli.net/2022/05/11/mq3OWtuSpK8IPLf.png)
比如说一个网站要注册用户，就会把用户输入的信息存储到数据库。就是存储型xss
反射型xss的执行(用户正常登录时服务器会返回一个cookie,从而攻击者利用这个cookie成功登录服务器)
![20220511211334](https://s2.loli.net/2022/05/11/7j9v6oHRbdKJMFw.png)
![20220511211537](https://s2.loli.net/2022/05/11/8FGhV1cYXC56Aeo.png)
存储型xss攻击者不用跟用户进行交互
![20220511211614](https://s2.loli.net/2022/05/11/g1Tm3BEjOoLWxId.png)
![20220511212219](https://s2.loli.net/2022/05/11/d3VqFTPb9UQz8ex.png)
代码回显到源码是在一个textarea标签里的，即$<td><textarea>里的内容</textarea></td>$都会以文本形式表现，而我们不想让script以文本形式而是以脚本形式表现，所以可以提前闭合

dom的最大特点是不会经过服务器和服务器解析，而是直接被浏览器的dom解析
![20220511212825](https://s2.loli.net/2022/05/11/yiXhFSvYsdACa1K.png)
如我们在下拉框里选择的参数根本没经过服务器，而是直接被浏览器解析
![20220511212947](https://s2.loli.net/2022/05/11/wJZUTABf5LnFesq.png)
![20220511213054](https://s2.loli.net/2022/05/11/wr2PIKidzUNxBsD.png)
对用户输入长度的限制是无效的因为我们可以通过中间人的方式绕过。
![20220511213312](https://s2.loli.net/2022/05/11/NipaIUmqMWysX8f.png)

## csrf
![20220511213404](https://s2.loli.net/2022/05/11/a8P7yvofmG4qIZU.png)
更新管理员密码
![20220511214024](https://s2.loli.net/2022/05/11/Kc9Pe4HNCsfuSAh.png)
![20220511213723](https://s2.loli.net/2022/05/11/Zsq53c78AdbxhjJ.png)
xss:攻击者获取了用户cookie然后登录网站
csrf:攻击者事先构造好一个操作，诱导用户用cookie去执行恶意代码
![20220511214232](https://s2.loli.net/2022/05/11/NVz9KxcZWICkMyY.png)

## 文件上传漏洞
![20220511214331](https://s2.loli.net/2022/05/11/Fg6WNcdXl4DLAMR.png)
前端的文件类型限制可通过中间人绕过。
![20220511214607](https://s2.loli.net/2022/05/11/6ao9JbYfPmrTwFl.png)
![20220511214728](https://s2.loli.net/2022/05/11/oLUV6tyhDdaervJ.png)
可以看到这里的代码有漏洞，通过indexof的方式获取后缀，即查找第一个.出现的位置，而我们可以修改文件名为两个..，可换成lastindexof()
![20220511214903](https://s2.loli.net/2022/05/11/tXqIVh4kz8KrAn1.png)

![20220511221752](https://s2.loli.net/2022/05/11/b5xFotVDeiprkHJ.png)
执行POST请求传入的参数c后面的str
![20220511221920](https://s2.loli.net/2022/05/11/UPrNStsk7mV1L42.png)
判断是不是客户端检测：把文件传到了浏览器但还没点上传时就已经弹出了限制，或burp检测还没有数据包被发送到服务端
![20220511222131](https://s2.loli.net/2022/05/11/u5KZ1H6rPehiVYd.png)
![20220511222205](https://s2.loli.net/2022/05/11/uwXG96xRBO5yLi4.png)
![20220511222246](https://s2.loli.net/2022/05/11/Gpy5KMlE6CjJB8A.png)
![20220511222300](https://s2.loli.net/2022/05/11/EjAWl7Pcxtm2S3B.png)
![20220511222417](https://s2.loli.net/2022/05/11/RNDTGpxfeuBrcPt.png)
![20220511222448](https://s2.loli.net/2022/05/11/TEaqdVINzke7JXM.png)
![20220511222845](https://s2.loli.net/2022/05/11/MUVgBeWvR4QqoNf.png)
![20220511223118](https://s2.loli.net/2022/05/11/kSaAoFUNlKzYsGr.png)
windows系统会自动去掉命名后面的空格，所以修改文件名要在burp里做
![20220511223239](https://s2.loli.net/2022/05/11/H13n8xWiQreJc6K.png)
这里就是通过小马为大马开后门？
图片马的条件：1.我可以在服务器端建立一个xx.asp的文件夹。
2.我可以上传xx.jpg到这个文件夹下
![20220511223529](https://s2.loli.net/2022/05/11/fYIsxLPJNm4XnSQ.png)
![20220511223659](https://s2.loli.net/2022/05/11/Z4MFhdbqE5K8VvR.png)
apache从右到左，遇到不可解析的rar，owf都会无视掉。
## 路径遍历漏洞
![20220511215054](https://s2.loli.net/2022/05/11/NYtUbjrlmWcEoui.png)
../：返回上一级目录，可无限返回
![20220511215241](https://s2.loli.net/2022/05/11/NQLR84VHBJGyPpI.png)
即用户不能直接输入文件的真实地址来下载，或直接给出下载文件的链接
![20220511223947](https://s2.loli.net/2022/05/11/57rXYUMibSTJeuO.png)
上传test.jpg,当test.ph不存在，则会递归向前解析将test.jpg当做pHp脚本解析，在当前目录下生成pHp的文件
![20220511224141](https://s2.loli.net/2022/05/11/8RLOAnr9TujzWyq.png)
![20220511224154](https://s2.loli.net/2022/05/11/UGIXSV1A4g8vzbt.png)

## 身份认证和权限控制
![20220511215355](https://s2.loli.net/2022/05/11/L9TzGSvJlqHOZDK.png)
![20220511215611](https://s2.loli.net/2022/05/11/tVQKBflRFIsDSg6.png)
被中间人嗅探到信息
![20220511215718](https://s2.loli.net/2022/05/11/cCnrojxu15HwDMz.png)
![20220511215757](https://s2.loli.net/2022/05/11/5r6Cm4bdzeD7JZa.png)
有一个网站模板需要我们登录之后才能下载，但我们把其链接拷贝到另一个没有登录信息的浏览器也可以下载(生成了特定链接)
![20220511215939](https://s2.loli.net/2022/05/11/pOH8xFUCXuMa2kK.png)
![20220511215953](https://s2.loli.net/2022/05/11/3tOrmTdwlWUMnBK.png)
![20220511220020](https://s2.loli.net/2022/05/11/Qvt2HGJbe6yoAd9.png)

## struts2漏洞
![20220511220405](https://s2.loli.net/2022/05/11/gvz9wrh4TolQfaA.png)
看response的回显判断存在表达式注入
![20220511220606](https://s2.loli.net/2022/05/11/BVqSbG2gzL13pu5.png)
## java反序列化漏洞
![20220511220759](https://s2.loli.net/2022/05/11/UQvLgtxdZ2pl41H.png)

# 三、信息泄露
## web源码泄露
Mercurial会用`hg init`命令创建版本库，生成一个.hg文件在网站根目录，往往会有版本更新和配置的信息
![20220511224640](https://s2.loli.net/2022/05/11/WbXxI9SHUYLsNEf.png)
![20220511224733](https://s2.loli.net/2022/05/11/puYbL2MG8I7ePcU.png)
![20220511224842](https://s2.loli.net/2022/05/11/wLgl2JFtqaT4jSP.png)
![20220511234010](https://s2.loli.net/2022/05/11/mN1XcwkbfTYWxqz.png)
ctf中通过获取pHp源码来进行代码审计
![20220511234101](https://s2.loli.net/2022/05/11/fjU1ubrGaqKdVJA.png)
![20220511234154](https://s2.loli.net/2022/05/11/n5OZiUDSsv7ybrc.png)
![20220511234254](https://s2.loli.net/2022/05/11/ktTYrZJLiFAlSVy.png)
![20220511234322](https://s2.loli.net/2022/05/11/wBb29Gj8ac7W5pg.png)
![20220511234355](https://s2.loli.net/2022/05/11/Dga5t9UY63mWyI2.png)
获取子域名就可以进行旁站攻击了
heartbleed:https协议，获取缓存中的用户cookie等信息
通过修改路径或http方法来使得页面报错，从而获取页面的堆栈信息错误
![20220511234640](https://s2.loli.net/2022/05/11/PTacuNpCb5xfqYm.png)
如图，xwork2是struts2的重要组件，判断出网站架构是struts2，再利用struts2漏洞来获取服务器权限

## 未授权访问漏洞
没配置凭证口令
![20220511235239](https://s2.loli.net/2022/05/11/uqgkzSWJNs23KXU.png)
![20220511235311](https://s2.loli.net/2022/05/11/mhkl56zwxjQGN7n.png)
![20220511235408](https://s2.loli.net/2022/05/11/QkZwjdr31vlKb2t.png)
![20220511235651](https://s2.loli.net/2022/05/11/MvQuAbedPgzGa74.png)
### 弱口令
凭证口令比较弱(123456,abcde)
### 空口令
可以配置没有口令的用户名(admin等)，可以直接登录进去
### 硬编码旁路凭证漏洞
![20220511235137](https://s2.loli.net/2022/05/11/yqLnUY3rZR6vFNO.png)

# 常见题型
## http协议
1.change request method 
GET请求被WAF或过滤器拦截，可改成POST请求,burp右键可一键改变
![20220511203542](https://s2.loli.net/2022/05/11/ZLHgxOKCkbhaz3P.png)
2.user-agent
![20220511203431](https://s2.loli.net/2022/05/11/m3rzTZ1psVGnAHX.png)
3.location
点击超链接时使用burp拦截
![20220511203658](https://s2.loli.net/2022/05/11/oay8NkxSV1BEbHn.png)
4.referer
修改referer的值为
![20220511204144](https://s2.loli.net/2022/05/11/gvyKrxiOEAt3ofc.png)
5.XFF
![20220511204400](https://s2.loli.net/2022/05/11/nrViKY8IbZs632d.png)
6.accept-language
![20220511204811](https://s2.loli.net/2022/05/11/JLUg3iz8YDtnKFx.png)
7.cookie
![20220511204859](https://s2.loli.net/2022/05/11/8LDmrW51qzPAaXQ.png)
8.服务端响应自定义了首部字段 
![20220511204941](https://s2.loli.net/2022/05/11/cdfq9YHJ7EiLs6K.png)




---
# 总结

---
# 参考资料
